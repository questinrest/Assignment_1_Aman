# RAG Pipeline Reranker

## Overview

This repository implements a simple Retrieval‑Augmented Generation (RAG) pipeline with a reranking step. It provides a FastAPI server exposing two main endpoints:

- **`POST /ingest`** – Ingest a document (PDF) into a Pinecone vector store.
- **`POST /query`** – Query the store and get an answer generated by a LLM, optionally reranked.

The pipeline uses:

- **Pinecone** for vector storage and similarity search.
- **GROQ** (or OpenAI) for embeddings and LLM generation.
- **FastAPI** as the web framework.

## Prerequisites

- **Python 3.11+**
- **Pinecone account** with an API key.
- **GROQ (or OpenAI) API key** for embeddings and generation.

## Installation

1. **Clone the repository**:
   ```bash
   git clone "https://github.com/questinrest/rag-pipeline-reranker"
   cd rag-pipeline-reranker"
   ```
2. **Create a virtual environment** (recommended):
   ```bash
   py -3.11 -m venv .venv
   .venv\Scripts\activate   # on Windows
   ```
3. **Install dependencies**:
   ```bash
   pip install -r requirements.txt
   ```

## Environment configuration

Create a `.env` file in the project root (same directory as `src/`) with the following variables:

```dotenv
PINECONE_API_KEY=<your‑pinecone‑api‑key>
GROQ_API_KEY=<your‑groq‑api‑key>
```

> **NOTE**: The code reads these variables via `src/config.py`. Ensure there are no extra spaces or quotes.

## Running the API server

The FastAPI application lives in `src/api.py`. To start the server locally:

```bash
uvicorn src.api:app --reload
```

- The server will be available at `http://127.0.0.1:8000`.
- Swagger UI can be accessed at `http://127.0.0.1:8000/docs` for interactive testing.

## Using the endpoints

### 1. Ingest a document

```bash
curl -X POST "http://127.0.0.1:8000/ingest" \
  -H "Content-Type: application/json" \
  -d '{"file_path": "path/to/your/document.pdf"}'
```

- The request body must contain `file_path` pointing to a PDF on the server's filesystem.
- The response includes the number of chunks up‑serted and a status message.

### 2. Query the knowledge base

```bash
curl -X POST "http://127.0.0.1:8000/query" \
  -H "Content-Type: application/json" \
  -d '{
        "query": "Your question here",
        "rerank": true
      }'
```

- Set `rerank` to `true` to use the reranking model (`bge‑reranker‑v2‑m3`).
- The response contains `answer`, `reference` (source documents), and the `rerank` flag.

## Project structure (Core Source Code)

```
├─ src/                     # Core source code
│   ├─ api.py               # FastAPI entry point
│   ├─ config.py            # Environment variables & constants
│   ├─ ingestion.py         # PDF loading, chunking, hashing
│   ├─ embedding.py         # Functions to embed chunks
│   ├─ retrieval.py         # Vector search
│   ├─ reranker.py          # Reranking logic
│   ├─ generation.py        # LLM answer generation
│   └─ utils.py             # Helper utilities
├─ docs/                    # Example PDFs or data files
├─ .env                     # (you create this)
├─ requirements.txt         # Python dependencies
└─ README.md                # ← this file
```


---
